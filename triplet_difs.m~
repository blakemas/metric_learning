n = 100;
p = 50;
d = 20;
num_samples = 10000;

% create some points
X = randn(n,p)/d^0.25;

% sparse K
K = zeros(p,p);
K(1:d,1:d) = eye(d);
G_sparse = X*K*X';

% dense K
U = orth(randn(p,p));
Sigma = zeros(p,p);
Sigma(1:d,1:d) = eye(d);
K = U*Sigma*U';
G_dense = X*K*X';

sparse_difs = 0;
dense_difs = 0;
for t=1:num_samples
    q = datasample(1:n, 3, 'replace', false);
    i = q(1);
    j = q(2);
    k = q(3);
    sparse_difs = sparse_difs + abs(G_sparse());